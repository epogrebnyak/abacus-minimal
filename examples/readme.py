"""This file is automatically generated from README.md"""

from abacus import (
    Asset,
    Book,
    Chart,
    Close,
    Double,
    Entry,
    Equity,
    Expense,
    Income,
    Ledger,
)

accounts = [
    Asset("cash"),
    Equity("equity"),
    Equity("re", title="Retained earnings"),
    Income("sales"),
    Expense("salaries"),
]
entries = [
    Double("cash", "equity", 1000),
    Double("cash", "sales", 250),
    Double("salaries", "cash", 150),
    Close("re"),
]
events = accounts + entries
ledger = Ledger.from_list(events)

print(ledger.balances)
print(ledger.income_statement())
print(ledger.balance_sheet())

for p in ledger.history.primitives:
    print(p)


# Create chart and ledger
chart = Chart(
    assets=["cash", "ar"],
    equity=["equity"],
    liabilities=["tax_due"],
    income=["services"],
    expenses=["salaries"],
    retained_earnings="retained_earnings",
    contra_accounts={"services": ["refunds"]},
)
book = Book.from_chart(chart)

# Post entries
entries = [
    Entry("Shareholder investment").double("cash", "equity", 1000),
    Entry("Incoice for services")
    .debit("ar", 1200)
    .credit("services", 1000)
    .credit("tax_due", 200),
    Entry("Paid salaries").double("salaries", "cash", 600),
]
book.post_many(entries)
print(book.balances)

# Close the period and show reports
book.close()
print(book.income_statement)
print(book.balance_sheet)

# Save, load and re-enter
book.chart.save("chart.json", allow_overwrite=True)
book.ledger.history.save("history.json", allow_overwrite=True)
